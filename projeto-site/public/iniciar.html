<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="iniciar.css">
    <script src="funcao.js"></script>
    <title>Planos</title>
</head>

<body>

    <a href="index.html"><img src="logo2.png" alt="" class="logo_menu"></a>
    <header>

        <nav>
            <ul>
                <li><a href="cadastro.html">Cadastre-se</a></li>
                <li><a href="iniciar.html">iniciar sessão</a></li>
                <li><a href="planos.html">Planos</a></li>
                <li><a href="conteudo.html">Conteúdo</a></li>

            </ul>
        </nav>

    </header>

    <img src="fundo3.png" alt="" style="opacity:0.2" class="imagemfundo">

    <form class="center container" id="form_login" method="post" onsubmit="return entrar()">
        <div class="campo_login">
            <input type="text" name="email" id="email" placeholder="Email"><br><br>
            <input type="text" name="senha" id="senha" placeholder="Senha"> <br><br>
            <button id="btn">Entrar</button>
        </div>
    </form>

</body>

</html>
<script src="funcao.js"></script>

<script>
    function entrar() {

        var formulario = new URLSearchParams(new FormData(form_login));
        fetch("/usuarios/autenticar", {
            method: "POST",
            body: formulario
        }).then(resposta => {

            if (resposta.ok) {

                resposta.json().then(json => {

                    sessionStorage.login_usuario_meuapp = json.email;
                    sessionStorage.nome_usuario_meuapp = json.nome;

                    window.location.href = 'tela_usuario.html';
                });

            } else {

                console.log('Erro de login!');


                response.text().then(texto => {
                    console.error(texto);

                });
            }
        });

        return false;
    }

</script>